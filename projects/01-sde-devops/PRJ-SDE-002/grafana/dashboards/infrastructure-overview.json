{
  "uid": "infra-overview",
  "title": "Infrastructure Overview",
  "timezone": "browser",
  "refresh": "30s",
  "time": {"from": "now-6h", "to": "now"},
  "panels": [
    {
      "type": "stat",
      "title": "Hosts Monitored",
      "gridPos": {"x":0,"y":0,"w":6,"h":3},
      "targets": [{"expr": "count(count by (instance) (up))"}],
      "options": {"colorMode": "value"}
    },
    {
      "type": "gauge",
      "title": "Uptime Percentage",
      "gridPos": {"x":6,"y":0,"w":6,"h":3},
      "targets": [{"expr": "avg(avg_over_time(up[24h]))"}],
      "options": {"min":0,"max":1,"reduceOptions":{"calcs":["mean"]},"thresholds":{"mode":"percentage","steps":[{"color":"green","value":0.7},{"color":"yellow","value":0.9},{"color":"red","value":0.95}]}}
    },
    {
      "type": "timeseries",
      "title": "Average CPU Usage",
      "gridPos": {"x":0,"y":3,"w":12,"h":4},
      "targets": [{"expr": "avg(rate(node_cpu_seconds_total{mode!='idle'}[5m])) by (instance)"}],
      "fieldConfig": {"defaults": {"unit": "percentunit", "thresholds": {"mode":"percentage","steps":[{"color":"green","value":0.7},{"color":"yellow","value":0.9},{"color":"red","value":0.95}]}}}
    },
    {
      "type": "timeseries",
      "title": "Average Memory Usage",
      "gridPos": {"x":0,"y":7,"w":12,"h":4},
      "targets": [{"expr": "avg((node_memory_MemTotal_bytes-node_memory_MemAvailable_bytes)/node_memory_MemTotal_bytes) by (instance)"}],
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "bargauge",
      "title": "Top CPU Hosts",
      "gridPos": {"x":0,"y":11,"w":6,"h":5},
      "targets": [{"expr": "topk(5, avg(rate(node_cpu_seconds_total{mode!='idle'}[5m])) by (instance))"}],
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "bargauge",
      "title": "Top Memory Hosts",
      "gridPos": {"x":6,"y":11,"w":6,"h":5},
      "targets": [{"expr": "topk(5, avg((node_memory_MemTotal_bytes-node_memory_MemAvailable_bytes)/node_memory_MemTotal_bytes) by (instance))"}],
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "table",
      "title": "Disk Usage by Host",
      "gridPos": {"x":0,"y":16,"w":12,"h":6},
      "targets": [{"expr": "node_filesystem_avail_bytes{fstype!~'tmpfs|overlay'} / node_filesystem_size_bytes{fstype!~'tmpfs|overlay'}"}],
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "timeseries",
      "title": "Network Traffic",
      "gridPos": {"x":0,"y":22,"w":12,"h":5},
      "targets": [{"expr": "sum(rate(node_network_receive_bytes_total[5m])) by (instance)"},{"expr": "sum(rate(node_network_transmit_bytes_total[5m])) by (instance)"}],
      "fieldConfig": {"defaults": {"unit": "Bps"}}
    },
    {
      "type": "state-timeline",
      "title": "Alert Status",
      "gridPos": {"x":0,"y":27,"w":12,"h":4},
      "targets": [{"expr": "ALERTS{alertstate='firing'}"}]
    }
  ]
}
