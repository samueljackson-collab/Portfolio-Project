graph TB
    subgraph "Monitored Infrastructure"
        HOST1[Proxmox Host<br/>192.168.10.10]
        HOST2[TrueNAS<br/>192.168.10.15]
        SERVICES[Services<br/>Wiki, HA, Immich]
        
        NE1[Node Exporter<br/>:9100]
        NE2[Node Exporter<br/>:9100]
        CA[cAdvisor<br/>:8080]
        
        HOST1 --> NE1
        HOST2 --> NE2
        SERVICES --> CA
    end
    
    subgraph "Observability Stack Container"
        PROM[Prometheus<br/>:9090]
        GRAF[Grafana<br/>:3000]
        LOKI[Loki<br/>:3100]
        PROMTAIL[Promtail]
        AM[Alertmanager<br/>:9093]
        BB[Blackbox Exporter<br/>:9115]
        
        NE1 -->|metrics| PROM
        NE2 -->|metrics| PROM
        CA -->|container metrics| PROM
        BB -->|http probes| PROM
        
        PROM -->|alerts| AM
        PROM -->|data source| GRAF
        LOKI -->|data source| GRAF
        
        PROMTAIL -->|logs| LOKI
    end
    
    subgraph "Log Sources"
        SYSLOGS[System Logs<br/>/var/log]
        DOCKER[Docker Logs]
        APPLOGS[Application Logs]
        
        SYSLOGS -->|scrape| PROMTAIL
        DOCKER -->|scrape| PROMTAIL
        APPLOGS -->|scrape| PROMTAIL
    end
    
    subgraph "Alerting Destinations"
        EMAIL[Email Notifications]
        SLACK[Slack<br/>optional]
        PD[PagerDuty<br/>optional]
        
        AM -->|critical| EMAIL
        AM -.->|optional| SLACK
        AM -.->|optional| PD
    end
    
    subgraph "Users"
        ADMIN[Admin User]
        
        ADMIN -->|view dashboards| GRAF
        ADMIN -->|query metrics| PROM
        ADMIN -->|manage alerts| AM
    end
    
    subgraph "Storage"
        PROM_DATA[(Prometheus TSDB<br/>30d retention)]
        LOKI_DATA[(Loki Storage<br/>30d retention)]
        GRAF_DATA[(Grafana DB)]
        
        PROM -->|store| PROM_DATA
        LOKI -->|store| LOKI_DATA
        GRAF -->|store| GRAF_DATA
    end
    
    style PROM fill:#e85d47,stroke:#333,color:#fff
    style GRAF fill:#f57c00,stroke:#333,color:#fff
    style LOKI fill:#f4a261,stroke:#333,color:#fff
    style AM fill:#e85d47,stroke:#333,color:#fff
