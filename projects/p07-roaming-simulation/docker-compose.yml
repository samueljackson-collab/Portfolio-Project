version: '3.8'

# Roaming Simulation - Telecom network simulation
services:
  # HLR/HSS Simulator
  hlr-simulator:
    build: .
    container_name: roaming-hlr
    ports:
      - "3868:3868"  # Diameter
    environment:
      - NODE_TYPE=HLR
      - REALM=example.com
    networks:
      - telecom-network

  # SMSC Simulator
  smsc-simulator:
    build: .
    container_name: roaming-smsc
    ports:
      - "2775:2775"  # SMPP
    environment:
      - NODE_TYPE=SMSC
    networks:
      - telecom-network

  # Traffic generator
  traffic-gen:
    build: .
    container_name: roaming-traffic
    environment:
      - HLR_HOST=hlr-simulator
      - SMSC_HOST=smsc-simulator
      - SCENARIO=international_roaming
    depends_on:
      - hlr-simulator
      - smsc-simulator
    profiles:
      - testing
    networks:
      - telecom-network

  # Monitoring
  prometheus:
    image: prom/prometheus:latest
    container_name: roaming-prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus:/etc/prometheus:ro
    networks:
      - telecom-network

networks:
  telecom-network:
    driver: bridge
