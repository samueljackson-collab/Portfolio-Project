# Prometheus Configuration for Multi-Region Disaster Recovery
# Monitors replication lag, regional health, failover readiness, RPO/RTO metrics

global:
  scrape_interval: 30s
  evaluation_interval: 30s
  external_labels:
    project: 'multi-region-dr'
    environment: 'production'

alerting:
  alertmanagers:
    - static_configs:
        - targets: ['alertmanager-us-east:9093', 'alertmanager-us-west:9093', 'alertmanager-eu-west:9093']

rule_files:
  - 'rules.yml'

scrape_configs:
  # Regional CloudWatch metrics
  - job_name: 'cloudwatch-us-east'
    static_configs:
      - targets: ['cloudwatch-exporter-us-east:9106']
    relabel_configs:
      - source_labels: [__address__]
        target_label: region
        replacement: 'us-east-1'

  - job_name: 'cloudwatch-us-west'
    static_configs:
      - targets: ['cloudwatch-exporter-us-west:9106']
    relabel_configs:
      - source_labels: [__address__]
        target_label: region
        replacement: 'us-west-2'

  - job_name: 'cloudwatch-eu-west'
    static_configs:
      - targets: ['cloudwatch-exporter-eu-west:9106']
    relabel_configs:
      - source_labels: [__address__]
        target_label: region
        replacement: 'eu-west-1'

  # Replication lag monitoring
  - job_name: 'replication-lag'
    static_configs:
      - targets: ['replication-monitor:9220']
    scrape_interval: 10s

  # Failover orchestrator
  - job_name: 'failover-orchestrator'
    static_configs:
      - targets: ['failover-service:8085']

  # Route53 health checks
  - job_name: 'route53-health'
    static_configs:
      - targets: ['route53-exporter:9221']

  # Cross-region VPN/interconnect
  - job_name: 'network-connectivity'
    static_configs:
      - targets: ['network-monitor:9222']
    scrape_interval: 15s

  # Backup verification
  - job_name: 'backup-verification'
    static_configs:
      - targets: ['backup-verifier:9223']
    scrape_interval: 300s
