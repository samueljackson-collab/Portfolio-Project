# NTP Time Synchronization Configuration
# Stratum 2 NTP Server for Homelab
# Last Updated: 2025-11-05

# Drift file location
driftfile /var/lib/ntp/ntp.drift

# Log file
logfile /var/log/ntp.log

# Statistics directory
statsdir /var/log/ntpstats/
statistics loopstats peerstats clockstats
filegen loopstats file loopstats type day enable
filegen peerstats file peerstats type day enable
filegen clockstats file clockstats type day enable

# Upstream NTP servers (Stratum 1)
server 0.pool.ntp.org iburst
server 1.pool.ntp.org iburst
server 2.pool.ntp.org iburst
server 3.pool.ntp.org iburst
server time.cloudflare.com iburst
server time.google.com iburst

# Fallback to local clock if all upstreams fail
server 127.127.1.0
fudge 127.127.1.0 stratum 10

# Access control
restrict default kod nomodify notrap nopeer noquery limited
restrict 127.0.0.1
restrict ::1
restrict 192.168.0.0 mask 255.255.0.0 nomodify notrap

# Enable monitoring
enable stats

# Disable kernel time discipline
disable kernel

# Maximum time adjustment
tinker panic 0
