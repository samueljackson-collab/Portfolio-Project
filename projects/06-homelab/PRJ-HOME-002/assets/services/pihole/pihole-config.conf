# Pi-hole Configuration File
# DNS-based Ad Blocker and Network-wide DNS Server
# Version: Pi-hole v5.x
# Last Updated: 2025-11-05
# Location: /etc/pihole/setupVars.conf

# Network Configuration
PIHOLE_INTERFACE=eth0
PIHOLE_DNS_1=1.1.1.1
PIHOLE_DNS_2=8.8.8.8
PIHOLE_DNS_3=1.0.0.1
PIHOLE_DNS_4=8.8.4.4
IPV4_ADDRESS=192.168.40.35/24
IPV6_ADDRESS=
QUERY_LOGGING=true
INSTALL_WEB_SERVER=true
INSTALL_WEB_INTERFACE=true
LIGHTTPD_ENABLED=true
CACHE_SIZE=10000
DNS_FQDN_REQUIRED=true
DNS_BOGUS_PRIV=true
DNSSEC=true
CONDITIONAL_FORWARDING=false

# Web Interface Configuration
WEBPASSWORD=<hashed_password>
# Generate with: pihole -a -p
WEB_PORT=80
BLOCKING_ENABLED=true
WEBUIBOXEDLAYOUT=boxed
WEBTHEME=default-dark

# Upstream DNS Servers
# Cloudflare DNS
PIHOLE_DNS_1=1.1.1.1#53
PIHOLE_DNS_2=1.0.0.1#53

# Google DNS (backup)
PIHOLE_DNS_3=8.8.8.8#53
PIHOLE_DNS_4=8.8.4.4#53

# Quad9 DNS (alternative)
# PIHOLE_DNS_1=9.9.9.9#53
# PIHOLE_DNS_2=149.112.112.112#53

# DNS Configuration
REV_SERVER=false
REV_SERVER_DOMAIN=homelab.local
REV_SERVER_TARGET=192.168.40.1
REV_SERVER_CIDR=192.168.0.0/16

# Privacy Settings
PRIVACYLEVEL=0
# 0 = Show everything
# 1 = Hide domains
# 2 = Hide domains and clients
# 3 = Anonymous mode

# Blocking Configuration
BLOCKING_ENABLED=true
RATE_LIMIT=1000/60
# 1000 queries per 60 seconds per client

# DHCP Server (if using Pi-hole as DHCP)
DHCP_ACTIVE=false
DHCP_START=192.168.40.100
DHCP_END=192.168.40.200
DHCP_ROUTER=192.168.40.1
DHCP_LEASETIME=24
PIHOLE_DOMAIN=homelab.local
DHCP_IPv6=false
DHCP_rapid_commit=false

# DNSSEC Configuration
DNSSEC=true
# Validates DNS responses using DNSSEC

# Conditional Forwarding
# Forward local domain queries to local DNS server (pfSense)
CONDITIONAL_FORWARDING=true
CONDITIONAL_FORWARDING_IP=192.168.40.1
CONDITIONAL_FORWARDING_DOMAIN=homelab.local
CONDITIONAL_FORWARDING_REVERSE=40.168.192.in-addr.arpa

# Temperature Unit
TEMPERATUREUNIT=C
# Options: C, F, K

# API and Web Settings
API_EXCLUDE_DOMAINS=
API_EXCLUDE_CLIENTS=
API_QUERY_LOG_SHOW=all
# Options: all, blocked, forwarded, cached

# Teleporter (Backup/Restore)
TELEPORTER_SETTINGS=true
TELEPORTER_SCHEDULE=weekly
# Automatic configuration backup

# Custom DNS Records (handled separately in custom-dns.list)
# See custom-dns.list file for local DNS entries

# Additional Settings
DNSMASQ_LISTENING=all
# Options: local, all, single

PIHOLE_PTR=NONE
# PTR record for Pi-hole hostname

# Performance Tuning
DNS_CACHE_SIZE=10000
# Increased cache for better performance

DNS_CACHE_TTL_MIN=0
DNS_CACHE_TTL_MAX=3600

# Query Filtering
REGEX_BLOCKING=true
EXACT_BLOCKING=true

# Logging
LOG_QUERIES=true
LOG_INSTALL=/var/log/pihole-install.log
LOG_G=/var/log/pihole-FTL.log

# FTL (Faster Than Light) Configuration
# Additional settings in /etc/pihole/pihole-FTL.conf

# Database Settings
MAXDBDAYS=365
# Keep query database for 365 days

# Privacy Features
ANALYZE_ONLY_A_AND_AAAA=false
SHOW_DNSSEC=true
MOZILLA_CANARY=true
# Disable Firefox DNS-over-HTTPS

# Block Page
BLOCKINGMODE=IP-NODATA-AAAA
# Options: NULL, IP, IP-NODATA-AAAA, NXDOMAIN

# Custom Block Page (optional)
# CUSTOMBLOCKPAGE=

# API Authentication
# API_AUTH_KEY is stored separately for security

# Update Configuration
# Automatic updates disabled in production
# Manual updates recommended with testing
UPDATE_CHECKER=weekly

# Whitelist/Blacklist Management
# Managed via web interface or CLI:
# pihole -w domain.com  # Whitelist
# pihole -b domain.com  # Blacklist
# pihole -regex "pattern"  # Regex filter

# Statistics
STATS_INTERVAL=3600
# Update statistics every hour

# Gravity Update (Blocklist Update)
# Runs weekly via cron
# Manual: pihole -g

# Notes:
# 1. Restart Pi-hole after config changes: pihole restartdns
# 2. Regenerate gravity after adding blocklists: pihole -g
# 3. View real-time logs: pihole -t
# 4. Check status: pihole status
# 5. Update Pi-hole: pihole -up
# 6. Repair installation: pihole -r
# 7. Uninstall: pihole uninstall

# Integration with pfSense:
# 1. Set pfSense DNS server to Pi-hole (192.168.40.35)
# 2. Configure DHCP to distribute Pi-hole as DNS
# 3. Enable conditional forwarding for local domains
# 4. Firewall rule: Allow DNS (53/UDP) from all VLANs to Pi-hole

# Monitoring:
# - Web interface: http://192.168.40.35/admin
# - API endpoint: http://192.168.40.35/admin/api.php
# - Metrics for Prometheus: /var/log/pihole-FTL.log
# - Install pihole-exporter for Prometheus integration

# Backup:
# - Configuration: /etc/pihole/
# - Database: /etc/pihole/pihole-FTL.db
# - Custom lists: /etc/pihole/custom.list
# - Use Teleporter for web-based backup

# Security:
# - Change default password immediately
# - Enable DNSSEC for validation
# - Use strong upstream DNS (DoH/DoT capable)
# - Regular updates
# - Monitor for DNS amplification attacks
# - Rate limiting enabled

# Performance Tips:
# - Increase cache size for busy networks
# - Use fast upstream DNS servers
# - Regular database optimization
# - Monitor memory usage
# - Consider DNS-over-HTTPS for privacy
