version: '3.8'

services:
  immich-server:
    image: ghcr.io/immich-app/immich-server:release
    volumes:
      - /mnt/nfs/immich:/usr/src/app/upload
    depends_on:
      - database
    restart: unless-stopped

  database:
    image: tensorchord/pgvecto-rs:pg14-v0.2.0
    environment:
      POSTGRES_PASSWORD: changeme
      POSTGRES_USER: immich
    volumes:
      - pgdata:/var/lib/postgresql/data

volumes:
  pgdata: