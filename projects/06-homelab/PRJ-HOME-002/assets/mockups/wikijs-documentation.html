<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homelab Infrastructure Overview - Wiki.js</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f7fa;
            color: #1e293b;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: #1e3a8a;
            color: white;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 60px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 600;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1e3a8a;
        }

        .search-bar {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 6px;
            width: 350px;
            color: white;
            font-size: 14px;
        }

        .search-bar::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-button {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .header-button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
        }

        /* Layout */
        .container {
            display: flex;
            min-height: calc(100vh - 60px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e2e8f0;
            padding: 24px 0;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 24px;
            padding: 0 16px;
        }

        .sidebar-title {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 4px;
            color: #475569;
        }

        .nav-item:hover {
            background: #f1f5f9;
        }

        .nav-item.active {
            background: #eff6ff;
            color: #1e3a8a;
            font-weight: 500;
        }

        .nav-item-icon {
            width: 18px;
            height: 18px;
        }

        .nav-item-expand {
            margin-left: auto;
            font-size: 12px;
        }

        .nav-subitems {
            margin-left: 28px;
            margin-top: 4px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 32px;
            max-width: 900px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #64748b;
            margin-bottom: 24px;
        }

        .breadcrumb-separator {
            color: #cbd5e1;
        }

        .page-header {
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 32px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 12px;
        }

        .page-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 13px;
            color: #64748b;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .content {
            background: white;
            padding: 32px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            line-height: 1.7;
        }

        .content h2 {
            font-size: 24px;
            font-weight: 600;
            color: #1e293b;
            margin: 32px 0 16px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
        }

        .content h2:first-child {
            margin-top: 0;
        }

        .content h3 {
            font-size: 20px;
            font-weight: 600;
            color: #334155;
            margin: 24px 0 12px 0;
        }

        .content p {
            margin-bottom: 16px;
            color: #475569;
        }

        .content ul, .content ol {
            margin: 16px 0;
            padding-left: 24px;
        }

        .content li {
            margin-bottom: 8px;
            color: #475569;
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 16px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info-box-title {
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 16px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box-title {
            font-weight: 600;
            color: #d97706;
            margin-bottom: 8px;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 16px 0;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .inline-code {
            background: #f1f5f9;
            color: #e11d48;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 20px 0;
        }

        .metric-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 16px;
            border-radius: 6px;
        }

        .metric-label {
            font-size: 12px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
        }

        .metric-subtext {
            font-size: 12px;
            color: #64748b;
            margin-top: 4px;
        }

        /* Table of Contents */
        .toc {
            width: 250px;
            padding: 24px;
            background: white;
            border-left: 1px solid #e2e8f0;
            position: sticky;
            top: 76px;
            height: fit-content;
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        .toc-title {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 16px;
        }

        .toc-item {
            font-size: 14px;
            color: #64748b;
            padding: 6px 0;
            cursor: pointer;
            border-left: 2px solid transparent;
            padding-left: 12px;
            margin-left: -12px;
        }

        .toc-item:hover {
            color: #1e3a8a;
        }

        .toc-item.active {
            color: #1e3a8a;
            border-left-color: #1e3a8a;
            font-weight: 500;
        }

        .toc-subitem {
            font-size: 13px;
            padding-left: 24px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-operational {
            background: #dcfce7;
            color: #166534;
        }

        .status-warning {
            background: #fef3c7;
            color: #d97706;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">W</div>
                <span>Homelab Documentation</span>
            </div>
            <input type="text" class="search-bar" placeholder="Search documentation...">
        </div>
        <div class="header-right">
            <button class="header-button">+ New Page</button>
            <button class="header-button">Edit</button>
            <div class="user-avatar">SJ</div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Getting Started</div>
                <div class="nav-item">
                    <span class="nav-item-icon">üìñ</span>
                    <span>Introduction</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üéØ</span>
                    <span>Quick Start Guide</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Infrastructure</div>
                <div class="nav-item active">
                    <span class="nav-item-icon">üèóÔ∏è</span>
                    <span>Architecture Overview</span>
                    <span class="nav-item-expand">‚ñº</span>
                </div>
                <div class="nav-subitems">
                    <div class="nav-item">
                        <span class="nav-item-icon">üåê</span>
                        <span>Network Topology</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-item-icon">üíæ</span>
                        <span>Storage Configuration</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-item-icon">üîê</span>
                        <span>Security Setup</span>
                    </div>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üì¶</span>
                    <span>Services</span>
                    <span class="nav-item-expand">‚ñ∂</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üîÑ</span>
                    <span>Backup & Recovery</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Operations</div>
                <div class="nav-item">
                    <span class="nav-item-icon">üìä</span>
                    <span>Monitoring</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üö®</span>
                    <span>Incident Response</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üìù</span>
                    <span>Runbooks</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üîß</span>
                    <span>Maintenance Procedures</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Development</div>
                <div class="nav-item">
                    <span class="nav-item-icon">üíª</span>
                    <span>Development Environment</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">üê≥</span>
                    <span>Docker Configurations</span>
                </div>
                <div class="nav-item">
                    <span class="nav-item-icon">‚öôÔ∏è</span>
                    <span>CI/CD Pipelines</span>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="breadcrumb">
                <span>Home</span>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <span>Infrastructure</span>
                <span class="breadcrumb-separator">‚Ä∫</span>
                <span style="color: #1e3a8a;">Architecture Overview</span>
            </div>

            <div class="page-header">
                <h1 class="page-title">Infrastructure Architecture Overview</h1>
                <div class="page-meta">
                    <div class="meta-item">
                        <span>üìÖ</span>
                        <span>Last updated: November 6, 2025</span>
                    </div>
                    <div class="meta-item">
                        <span>‚úçÔ∏è</span>
                        <span>Sam Jackson</span>
                    </div>
                    <div class="meta-item">
                        <span class="status-badge status-operational">Production</span>
                    </div>
                </div>
            </div>

            <div class="content">
                <p>This document provides a comprehensive overview of the homelab infrastructure architecture, including hardware specifications, network topology, service deployments, and operational procedures.</p>

                <h2>System Overview</h2>

                <p>The homelab infrastructure is built on Proxmox VE hypervisor running on a Dell PowerEdge R720 server, providing a production-grade environment for learning, experimentation, and portfolio development.</p>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-label">Total VMs</div>
                        <div class="metric-value">6</div>
                        <div class="metric-subtext">All running</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Containers</div>
                        <div class="metric-value">3</div>
                        <div class="metric-subtext">LXC containers</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Uptime</div>
                        <div class="metric-value">99.5%</div>
                        <div class="metric-subtext">Last 45 days</div>
                    </div>
                </div>

                <h2>Hardware Specifications</h2>

                <h3>Proxmox Host Server</h3>
                <ul>
                    <li><strong>Model:</strong> Dell PowerEdge R720</li>
                    <li><strong>CPU:</strong> 2x Intel Xeon E5-2650 v2 (32 cores total)</li>
                    <li><strong>RAM:</strong> 128GB DDR3 ECC</li>
                    <li><strong>Storage:</strong>
                        <ul>
                            <li>2x 500GB SSD (RAID 1) - System/VM storage</li>
                            <li>4x 2TB HDD (RAID 10) - Bulk storage</li>
                        </ul>
                    </li>
                    <li><strong>Network:</strong> 4x 1Gbps NICs (bonded)</li>
                </ul>

                <h3>Network Equipment</h3>
                <ul>
                    <li><strong>Router:</strong> pfSense on dedicated hardware (4GB RAM, quad-core)</li>
                    <li><strong>Switch:</strong> Ubiquiti UniFi 24-port PoE managed switch</li>
                    <li><strong>Access Points:</strong> 2x UniFi AP AC Pro</li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">üí° Performance Note</div>
                    <div>The server is capable of running 15-20 VMs concurrently with current resource allocation. Currently utilizing ~40% of available resources for headroom during peak loads.</div>
                </div>

                <h2>Virtual Machine Inventory</h2>

                <h3>Production VMs</h3>

                <p>All production VMs run Ubuntu 22.04 LTS for consistency and long-term support.</p>

                <ol>
                    <li>
                        <strong>wiki-vm</strong> - <span class="inline-code">192.168.1.10</span>
                        <ul>
                            <li>Service: Wiki.js documentation platform</li>
                            <li>Resources: 2 vCPU, 4GB RAM, 50GB disk</li>
                            <li>Purpose: Internal documentation and knowledge base</li>
                        </ul>
                    </li>
                    <li>
                        <strong>homeassistant-vm</strong> - <span class="inline-code">192.168.1.11</span>
                        <ul>
                            <li>Service: Home Assistant smart home platform</li>
                            <li>Resources: 2 vCPU, 4GB RAM, 32GB disk</li>
                            <li>Purpose: IoT device management and automation</li>
                        </ul>
                    </li>
                    <li>
                        <strong>immich-vm</strong> - <span class="inline-code">192.168.1.12</span>
                        <ul>
                            <li>Service: Immich photo management system</li>
                            <li>Resources: 4 vCPU, 8GB RAM, 500GB disk</li>
                            <li>Purpose: Self-hosted photo backup and organization</li>
                        </ul>
                    </li>
                    <li>
                        <strong>monitoring-vm</strong> - <span class="inline-code">192.168.1.20</span>
                        <ul>
                            <li>Services: Prometheus, Grafana, Loki</li>
                            <li>Resources: 4 vCPU, 8GB RAM, 100GB disk</li>
                            <li>Purpose: Infrastructure monitoring and observability</li>
                        </ul>
                    </li>
                    <li>
                        <strong>database-vm</strong> - <span class="inline-code">192.168.1.30</span>
                        <ul>
                            <li>Service: PostgreSQL 15 (shared database)</li>
                            <li>Resources: 4 vCPU, 16GB RAM, 200GB disk</li>
                            <li>Purpose: Centralized database for all services</li>
                        </ul>
                    </li>
                    <li>
                        <strong>reverse-proxy-vm</strong> - <span class="inline-code">192.168.1.5</span>
                        <ul>
                            <li>Service: Nginx Proxy Manager</li>
                            <li>Resources: 2 vCPU, 2GB RAM, 20GB disk</li>
                            <li>Purpose: Reverse proxy with SSL/TLS termination</li>
                        </ul>
                    </li>
                </ol>

                <h2>Network Architecture</h2>

                <h3>VLAN Segmentation</h3>

                <p>Network is segmented into VLANs for security and traffic isolation:</p>

                <ul>
                    <li><strong>VLAN 10 (Management):</strong> 192.168.10.0/24 - Proxmox host, IPMI, network equipment</li>
                    <li><strong>VLAN 20 (Services):</strong> 192.168.1.0/24 - Production VMs and containers</li>
                    <li><strong>VLAN 30 (IoT):</strong> 192.168.30.0/24 - Smart home devices (isolated)</li>
                    <li><strong>VLAN 40 (Guest):</strong> 192.168.40.0/24 - Guest WiFi network</li>
                </ul>

                <div class="warning-box">
                    <div class="warning-box-title">‚ö†Ô∏è Security Notice</div>
                    <div>IoT VLAN (30) has strict firewall rules preventing access to management and services VLANs. Only specific services (Home Assistant) can communicate with IoT devices via firewall exceptions.</div>
                </div>

                <h3>Firewall Rules</h3>

                <p>pfSense firewall enforces the following key rules:</p>

                <div class="code-block">
# Allow management VLAN to all networks
VLAN 10 ‚Üí ALL: ALLOW

# Services can access database
VLAN 20 ‚Üí 192.168.1.30:5432: ALLOW

# IoT isolated except Home Assistant
VLAN 30 ‚Üí DENY (default)
192.168.1.11 ‚Üí VLAN 30: ALLOW (Home Assistant only)

# Guest network internet only
VLAN 40 ‚Üí Internet: ALLOW
VLAN 40 ‚Üí Internal: DENY
                </div>

                <h2>Service Access</h2>

                <p>All services are accessible via reverse proxy with SSL certificates from Let's Encrypt:</p>

                <ul>
                    <li><strong>Wiki.js:</strong> <span class="inline-code">https://wiki.homelab.local</span></li>
                    <li><strong>Home Assistant:</strong> <span class="inline-code">https://home.homelab.local</span></li>
                    <li><strong>Immich:</strong> <span class="inline-code">https://photos.homelab.local</span></li>
                    <li><strong>Grafana:</strong> <span class="inline-code">https://grafana.homelab.local</span></li>
                    <li><strong>Proxmox:</strong> <span class="inline-code">https://proxmox.homelab.local:8006</span></li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">üîê SSL Certificates</div>
                    <div>All certificates are automatically renewed via DNS challenge using Cloudflare API. Certificate expiry is monitored via Prometheus with alerting configured for 30 days before expiration.</div>
                </div>

                <h2>Backup Strategy</h2>

                <h3>VM Backups</h3>

                <p>Proxmox Backup Server (PBS) performs automated backups:</p>

                <ul>
                    <li><strong>Schedule:</strong> Daily at 2:00 AM</li>
                    <li><strong>Retention:</strong> 7 daily, 4 weekly, 3 monthly</li>
                    <li><strong>Storage:</strong> Dedicated 4TB NAS with offsite replication</li>
                    <li><strong>RPO:</strong> 1 hour (critical VMs have additional incremental backups)</li>
                    <li><strong>RTO:</strong> 15 minutes for VM restoration</li>
                </ul>

                <h3>Database Backups</h3>

                <p>PostgreSQL automated backups run via cron:</p>

                <div class="code-block">
# Daily full backup
0 1 * * * /scripts/backup-postgres.sh full

# Hourly incremental backup
0 * * * * /scripts/backup-postgres.sh incremental
                </div>

                <h2>Monitoring & Alerting</h2>

                <p>Comprehensive monitoring stack provides real-time observability:</p>

                <h3>Metrics Collection</h3>
                <ul>
                    <li><strong>Prometheus:</strong> Scrapes metrics from all VMs and services every 15 seconds</li>
                    <li><strong>Node Exporter:</strong> Installed on all VMs for system metrics</li>
                    <li><strong>Postgres Exporter:</strong> Database performance metrics</li>
                    <li><strong>Proxmox Exporter:</strong> Hypervisor resource utilization</li>
                </ul>

                <h3>Visualization</h3>
                <ul>
                    <li><strong>Grafana:</strong> 12 custom dashboards for different service categories</li>
                    <li><strong>Alertmanager:</strong> Routes alerts to Slack and email</li>
                    <li><strong>Uptime Kuma:</strong> External monitoring for service availability</li>
                </ul>

                <h2>Maintenance Windows</h2>

                <p>Scheduled maintenance occurs during low-usage periods:</p>

                <ul>
                    <li><strong>Patch Tuesday:</strong> Second Tuesday of each month, 10:00 PM - 12:00 AM</li>
                    <li><strong>Monthly Reboot:</strong> First Sunday, 3:00 AM (staggered VM restarts)</li>
                    <li><strong>Quarterly Hardware Maintenance:</strong> Announced 2 weeks in advance</li>
                </ul>

                <div class="info-box">
                    <div class="info-box-title">üì¢ Change Management</div>
                    <div>All infrastructure changes follow documented change management procedures. Critical changes require peer review and rollback plan documentation.</div>
                </div>

                <h2>Disaster Recovery</h2>

                <p>Tested disaster recovery procedures ensure business continuity:</p>

                <ol>
                    <li><strong>Full Infrastructure Loss:</strong> Restore from PBS backup to new hardware (RTO: 4 hours)</li>
                    <li><strong>Database Failure:</strong> Restore from latest backup (RTO: 15 minutes, RPO: 1 hour)</li>
                    <li><strong>Network Outage:</strong> Failover to LTE backup connection (automatic)</li>
                    <li><strong>Service Degradation:</strong> Rolling restart procedures documented per service</li>
                </ol>

                <h2>Related Documentation</h2>

                <ul>
                    <li><a href="#" style="color: #1e3a8a;">Network Topology Diagram ‚Üí</a></li>
                    <li><a href="#" style="color: #1e3a8a;">Service Runbooks ‚Üí</a></li>
                    <li><a href="#" style="color: #1e3a8a;">Incident Response Procedures ‚Üí</a></li>
                    <li><a href="#" style="color: #1e3a8a;">Security Hardening Checklist ‚Üí</a></li>
                    <li><a href="#" style="color: #1e3a8a;">Database Administration Guide ‚Üí</a></li>
                </ul>
            </div>
        </main>

        <!-- Table of Contents -->
        <aside class="toc">
            <div class="toc-title">On This Page</div>
            <div class="toc-item active">System Overview</div>
            <div class="toc-item">Hardware Specifications</div>
            <div class="toc-subitem toc-item">Proxmox Host Server</div>
            <div class="toc-subitem toc-item">Network Equipment</div>
            <div class="toc-item">Virtual Machine Inventory</div>
            <div class="toc-subitem toc-item">Production VMs</div>
            <div class="toc-item">Network Architecture</div>
            <div class="toc-subitem toc-item">VLAN Segmentation</div>
            <div class="toc-subitem toc-item">Firewall Rules</div>
            <div class="toc-item">Service Access</div>
            <div class="toc-item">Backup Strategy</div>
            <div class="toc-item">Monitoring & Alerting</div>
            <div class="toc-item">Maintenance Windows</div>
            <div class="toc-item">Disaster Recovery</div>
            <div class="toc-item">Related Documentation</div>
        </aside>
    </div>
</body>
</html>
