# Proxmox VE Network Configuration
# /etc/network/interfaces
#
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# Loopback interface
auto lo
iface lo inet loopback

# Physical uplink to UniFi switch (trunk port)
auto enp0s31f6
iface enp0s31f6 inet manual
    mtu 9000

# Management VLAN (VLAN 10)
auto vmbr0
iface vmbr0 inet static
    address 192.168.10.10/24
    gateway 192.168.10.1
    bridge_ports enp0s31f6.10
    bridge_stp off
    bridge_fd 0
    bridge_vlan_aware yes
    bridge_vids 2-4094
    mtu 9000
    # DNS servers
    dns-nameservers 192.168.10.1 1.1.1.1

# Admin VLAN (VLAN 20)
auto vmbr0.20
iface vmbr0.20 inet static
    address 192.168.20.10/24
    vlan-raw-device vmbr0
    mtu 9000

# Application VLAN (VLAN 30)
auto vmbr0.30
iface vmbr0.30 inet static
    address 192.168.30.10/24
    vlan-raw-device vmbr0
    mtu 9000

# IoT VLAN (VLAN 40)
auto vmbr0.40
iface vmbr0.40 inet static
    address 192.168.40.10/24
    vlan-raw-device vmbr0
    mtu 9000

# UniFi Protect VLAN (VLAN 50)
auto vmbr0.50
iface vmbr0.50 inet static
    address 192.168.50.10/24
    vlan-raw-device vmbr0
    mtu 9000

# Post-up commands for security hardening
post-up echo 1 > /proc/sys/net/ipv4/ip_forward
post-up echo 0 > /proc/sys/net/ipv4/conf/all/accept_redirects
post-up echo 0 > /proc/sys/net/ipv4/conf/all/send_redirects
post-up echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts
