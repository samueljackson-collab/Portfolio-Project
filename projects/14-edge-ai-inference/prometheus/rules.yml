# Alert Rules for Edge AI Inference

groups:
  - name: edge_ai_alerts
    interval: 30s
    rules:
      - alert: EdgeDeviceOffline
        expr: edge_device_online == 0
        for: 5m
        labels:
          severity: warning
          component: device
        annotations:
          summary: "Edge device {{ $labels.device_id }} offline"
          description: "Device unreachable for 5 minutes"

      - alert: EdgeInferenceLatencyHigh
        expr: histogram_quantile(0.95, rate(edge_inference_duration_seconds_bucket[5m])) > 0.5
        for: 10m
        labels:
          severity: warning
          component: inference
        annotations:
          summary: "High inference latency on {{ $labels.device_id }}"
          description: "P95 latency: {{ $value }}s"

      - alert: EdgeDeviceCPUHigh
        expr: edge_device_cpu_usage_percent > 90
        for: 15m
        labels:
          severity: warning
          component: resources
        annotations:
          summary: "High CPU on edge device {{ $labels.device_id }}"
          description: "CPU: {{ $value }}%"

      - alert: EdgeDeviceMemoryLow
        expr: edge_device_memory_available_bytes / edge_device_memory_total_bytes < 0.1
        for: 10m
        labels:
          severity: warning
          component: resources
        annotations:
          summary: "Low memory on edge device {{ $labels.device_id }}"
          description: "Only {{ $value | humanizePercentage }} memory available"

      - alert: ModelSyncFailed
        expr: model_sync_failures_total > 0
        for: 5m
        labels:
          severity: warning
          component: model-sync
        annotations:
          summary: "Model sync failed for {{ $labels.device_id }}"
          description: "{{ $value }} sync failures"

      - alert: EdgeInferenceAccuracyDegraded
        expr: edge_inference_accuracy_score < 0.85
        for: 30m
        labels:
          severity: info
          component: model
        annotations:
          summary: "Inference accuracy degraded on {{ $labels.device_id }}"
          description: "Accuracy: {{ $value }}"
