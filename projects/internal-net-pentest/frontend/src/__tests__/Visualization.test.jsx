import { render, screen } from '@testing-library/react';
import '@testing-library/jest-dom';
import Visualization from '../components/Visualization';

test('shows reachability summary', () => {
  const paths = [
    { id: '1', name: 'Move', narrative: 'desc', steps: [{ from_host: 'a', to_host: 'b', technique: 'ssh' }], likelihood: 'high' },
  ];
  const lateral = { reachable_hosts: ['b'], description: 'summary' };

  render(<Visualization attackPaths={paths} lateral={lateral} />);
  expect(screen.getByText(/Reachable hosts/i)).toHaveTextContent('b');
  expect(screen.getByText('Move')).toBeInTheDocument();
});
