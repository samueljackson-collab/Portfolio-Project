services:
  backend:
    image: portfolio-backend:local
    build: ../backend
    ports: ["8000:8000"]
    environment:
      - DATABASE_URL=postgresql+asyncpg://postgres:postgres@postgres:5432/app
    depends_on: [postgres]
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000
  frontend:
    image: portfolio-frontend:local
    build: ../frontend
    ports: ["5173:80"]
    environment:
      - VITE_API_BASE=http://localhost:8000
    depends_on: [backend]
  postgres:
    image: postgres:16
    ports: ["5432:5432"]
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: app
