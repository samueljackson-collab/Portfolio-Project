# Prometheus alerting rules for the AWS infra application.
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: aws-infra-rules
spec:
  groups:
    - name: aws-infra-availability
      rules:
        - alert: AWSInfraHighErrorRate
          expr: rate(aws_infra_requests_total{status!~"2.."}[5m]) > 0
          for: 5m
          labels:
            severity: warning
          annotations:
            summary: "AWS Infra API has elevated error rate"
            description: "Investigate recent deployment or upstream AWS failures."
        - alert: AWSInfraMissingMetrics
          expr: absent(aws_infra_requests_total)
          for: 10m
          labels:
            severity: critical
          annotations:
            summary: "Prometheus lost visibility into AWS Infra API"
            description: "Ensure scraping, networking, and service availability."
