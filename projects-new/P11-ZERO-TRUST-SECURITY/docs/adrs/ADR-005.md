# ADR-005: Policy Distribution Approach

**Status:** Accepted  
**Date:** 2025-06-06

## Context
Zero Trust enforcement points (sidecars, gateways, and host agents) require consistent, auditable policy updates across regions and trust zones. Policies must be versioned, signed, and quickly rolled out with safe rollback while minimizing downtime and preventing stale configurations. The distribution mechanism must operate over mutually authenticated channels and support intermittent connectivity in edge locations.

## Decision
Use a **pull-based policy distribution model** backed by signed bundles:
- Author and store policies (e.g., OPA/Rego, RBAC, routing rules) in a Git repository; CI pipelines sign immutable bundles and publish them to an OCI-compatible registry.
- Enforcement agents poll a regional control plane over mTLS to fetch the latest bundle manifest, download bundles from the registry, verify signatures, and hot-reload policies atomically.
- The control plane exposes version metadata and health endpoints for observability and orchestrates staged rollouts (canary then global) via feature flags.

## Alternatives
- **Push-based distribution via message bus:** Faster fan-out but requires persistent connectivity, complicates idempotency, and increases blast radius for bad updates.
- **Config management tooling (e.g., Ansible/Puppet) for policies:** Familiar ops tooling but slower convergence, limited fine-grained rollout control, and heavier agents on minimal footprints.
- **Manual updates at gateways:** Lowest complexity but unscalable, error-prone, and incompatible with audit/compliance needs.

## Consequences
- Pull + signed bundles reduce reliance on continuous connectivity while providing strong integrity guarantees.
- Staged rollout support lowers risk of outages from policy regressions and simplifies rollback.
- Requires operating an OCI registry and control-plane APIs with HA; registry unavailability can delay updates (agents must cache last-known-good bundles).
- Adds CI/CD steps for signing and publishing, increasing pipeline complexity but improving compliance posture.
